Name,Description,Expression
% of Revenue(Category),Calculates each category's share of total revenue.,"
DIVIDE([Total Revenue],CALCULATE([Total Revenue],ALL('ccdb credit_card'[Card_Category])))"
% of Revenue(Chip),Calculates each chip usage group's share of total revenue.,"
DIVIDE([Total Revenue],CALCULATE([Total Revenue],ALL('ccdb credit_card'[Use Chip])))"
Activated Customers 30 Days,Sums the number of customers activated within 30 days.,"
SUM('ccdb credit_card'[Activation_30_Days])"
Average Customer Satisfaction Score,Calculates the average customer satisfaction score from the customer table.,"
AVERAGE('ccdb customer'[Cust_Satisfaction_Score])"
Average Transaction Value,Computes the average value per transaction by dividing total transaction amount by total transactions.,"
DIVIDE([Total Transaction Amount],[Total Transactions])"
Average Utilisation,Calculates the average card utilisation ratio across credit card records.,"
AVERAGE('ccdb credit_card'[Avg_Utilization_Ratio])"
CAC Payback (Weeks),Estimates CAC payback in weeks by dividing total customer acquisition cost by total revenue and annualizing to 52 weeks.,"
DIVIDE([Total Customer Acquition Cost],[Total Revenue])*52"
CAC per Customer,Calculates the customer acquisition cost per acquired customer.,"
DIVIDE([Total Customer Acquition Cost],[Total Customers])"
Churn % by Category,Calculates churn percentage by category by dividing high-risk customer count by total customers.,"
DIVIDE(
    CALCULATE([Total Customers],'ccdb credit_card'[Churn Risk] IN {""High Risk (Delinquent)"",""At Risk (Dormant High Value)""}),
    [Total Customers]
)"
Deliquency Rate,Calculates the delinquency rate as the share of delinquent accounts relative to total customers.,"
DIVIDE([Total Delinquent Accounts],[Total Customers])"
Fees Share of Revenue,Calculates what portion of revenue is generated by fees by dividing total annual fees by total revenue.,"
DIVIDE([Total Annual Fees],[Total Revenue])"
Heatmap Colour,"Returns a hex color for heatmap cells based on churn risk, profitability tier.","
VAR Risk = SELECTEDVALUE ('ccdb credit_card'[Churn Risk])
VAR Tier = SELECTEDVALUE ('ccdb credit_card'[Profitability Tier])
VAR Cnt  = [Total Customers]
RETURN
IF (
    Cnt = 0,
    ""#1C1E26"",   -- neutral dark for empty / zero cells
    SWITCH (
        TRUE (),

        -- High value & high risk → worst case
        Tier = ""High""
            && Risk IN { ""High Risk (Delinquent)"", ""At Risk (Dormant High Value)"", ""Watchlist (Heavy Revolver)"" },
            ""#C73B3B"",   -- darker red, easier on text

        -- Mid value & risky
        Tier = ""Mid""
            && Risk IN { ""High Risk (Delinquent)"", ""At Risk (Dormant High Value)"", ""Watchlist (Heavy Revolver)"" },
            ""#C97A2B"",

        -- Low value but risky
        Tier = ""Low""
            && Risk IN { ""High Risk (Delinquent)"", ""At Risk (Dormant High Value)"", ""Watchlist (Heavy Revolver)"" },
            ""#C9A531"",

        -- High value & healthy / stable
        Tier = ""High""
            && Risk IN { ""Healthy / Retain"", ""Stable"" },
            ""#5E9F1F"",

        -- Mid value & healthy
        Tier = ""Mid""
            && Risk IN { ""Healthy / Retain"", ""Stable"" },
            ""#1E7C96"",

        -- everything else → muted
        ""#2A2C36""
    )
)"
High Utilisation Customers,Counts customers with average utilisation greater than 75%.,"
CALCULATE(
    [Total Customers],
    'ccdb credit_card'[Avg_Utilization_Ratio]>0.75
)"
Interest Share of Revenue,Calculates the portion of revenue that comes from interest by dividing total interest earned by total revenue.,"
DIVIDE([Total Interest Earned],[Total Revenue])"
Net Revenue,Calculates net revenue by subtracting total customer acquisition cost from total revenue.,"
[Total Revenue]-[Total Customer Acquition Cost]"
Previous Quarter Churn Risk %,Calculates the churn % by category for the same period 91 days (approx. previous quarter) earlier.,"
CALCULATE(
    [Churn % by Category],
    DATEADD(
        Calender_Table[Week_Start_Date],
        -91,
        DAY
    )
)"
Previous Week Revenue,Calculates total revenue for the previous week by shifting the calendar week start date back 7 days.,"
CALCULATE(
    [Total Revenue],
    DATEADD(
        Calender_Table[Week_Start_Date],
        -7,
        DAY
    )
)"
Previous Week Transactions,Calculates total transactions for the previous week by shifting the calendar week start date back 7 days and returning the result.,"
VAR Prev =
    CALCULATE(
        [Total Transactions],
        DATEADD(Calender_Table[Week_Start_Date], -7, DAY)
    )
RETURN Prev"
Revenue per Customer,Calculates revenue per customer by dividing total revenue by total customers.,"
DIVIDE([Total Revenue],[Total Customers])"
Revenue(Rolling 4 Week Avg),Computes the rolling 4-week average of total revenue using a 28-day window ending at the current week start date.,"
AVERAGEX(
    DATESINPERIOD(
        Calender_Table[Week_Start_Date],
        MAX(Calender_Table[Week_Start_Date]),
        -28,
        DAY
    ),
    [Total Revenue]
)"
Total Annual Fees,Sums annual fees across credit card records.,SUM('ccdb credit_card'[Annual_Fees])
Total Customer Acquition Cost,Sums total customer acquisition cost across credit card records.,SUM('ccdb credit_card'[Customer_Acq_Cost])
Total Customers,Counts distinct customers (client numbers) and returns zero if none.,"
COALESCE(DISTINCTCOUNT('ccdb customer'[Client_Num]),0)"
Total Delinquent Accounts,Sums the number of delinquent accounts.,"
SUM('ccdb credit_card'[Delinquent_Acc])"
Total Interest Earned,Sums interest earned across credit card records.,SUM('ccdb credit_card'[Interest_Earned])
Total Revenue,Calculates the total revenue by summing up total annual fees and total interest earned from the customers,[Total Annual Fees]+[Total Interest Earned]
Total Transaction Amount,Calculates total transaction amount by summing up individual customer's transaction amount.,"
SUM('ccdb credit_card'[Total_Trans_Amt])"
Total Transactions,Calculates total number of transactions by summing up individual customers' transactions ,SUM('ccdb credit_card'[Total_Trans_Vol])
WoW Revenue % ▼,Calculates week-over-week revenue change as a percentage versus the previous week.,"
DIVIDE([Total Revenue]-[Previous Week Revenue],[Previous Week Revenue])"
